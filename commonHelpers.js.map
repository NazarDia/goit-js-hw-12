{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst refs = {\n  input: document.querySelector('[type=\"text\"]'),\n  searchBtn: document.querySelector('[type=\"submit\"]'),\n  gallery: document.querySelector('.gallery'),\n  loadBtn: document.querySelector('.js-load'),\n  loadDiv: document.querySelector('.js-loader'),\n};\n\nconst params = {\n  API_KEY: '41488002-513c6a9a4c115eae6a99045d3',\n};\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nlet currentPage = 1;\nconst per_page = 40;\nlet lightbox = new SimpleLightbox('.gallery a');\n\nasync function getGaleryItems(page = currentPage) {\n  const data = await axios\n    .get(\n      `?key=${params.API_KEY}&q=${refs.input.value}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${per_page}`\n    )\n    .then(resp => resp.data)\n    .catch(err => console.error(err));\n  return data;\n  cl;\n}\n\nrefs.searchBtn.addEventListener('click', onSearch);\nrefs.loadBtn.addEventListener('click', onClick);\n\nfunction onSearch(e) {\n  e.preventDefault();\n  currentPage = 1;\n\n  if (refs.input.value.trim() === '') {\n    return iziToast.error({\n      message: 'Sorry, the field must be filled in!',\n      position: 'topRight',\n    });\n  } else {\n    refs.gallery.innerHTML = '<span class=\"loader\"></span>';\n  }\n  getGaleryItems()\n    .then(data => {\n      refs.gallery.innerHTML = createMarkup(data.hits);\n      lightbox.refresh();\n\n      if (per_page >= data.totalHits) {\n        refs.loadBtn.hidden = true;\n      } else {\n        refs.loadBtn.hidden = false;\n      }\n    })\n    .catch(err => console.error(err));\n}\n\nfunction onClick(e) {\n  e.preventDefault();\n  currentPage += 1;\n\n  refs.loadDiv.innerHTML = '<span class=\"loader\"></span>';\n  refs.loadBtn.hidden = true;\n\n  getGaleryItems(currentPage).then(data => {\n    refs.gallery.insertAdjacentHTML('beforeend', createMarkup(data.hits));\n    lightbox.refresh();\n\n    if (data.totalHits / per_page <= currentPage) {\n      refs.loadBtn.hidden = true;\n      refs.loadDiv.innerHTML = '';\n      return iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    } else if (data.totalHits / per_page >= currentPage) {\n      refs.loadDiv.innerHTML = '';\n      refs.loadBtn.hidden = false;\n    }\n\n    const galeryItem = document.querySelector('.gallery-item');\n    let rect = galeryItem.getBoundingClientRect();\n    scrollBy({\n      top: rect.height * 3,\n      behavior: 'smooth',\n    });\n  });\n}\n\nfunction createMarkup(arr) {\n  if (arr.length === 0) {\n    iziToast.error({\n      message:\n        'Sorry, there are no images matching <br> your search query. Please try again!',\n      position: 'topRight',\n    });\n  }\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `\n    <li class='gallery-item'>\n        <a href='${largeImageURL}'>\n            <img src=\"${webformatURL}\" alt=\"${tags}\" data-source=${largeImageURL} class='gallery-img'/>\n        </a>\n        <div class='text-container'>\n            <p>Likes<span>${likes}</span></p>\n            <p>Views<span>${views}</span></p>\n            <p>Comments<span>${comments}</span></p>\n            <p>Downloads<span>${downloads}</span></p>\n        </div>\n    </li>`;\n      }\n    )\n    .join('');\n}\n"],"names":["refs","params","axios","currentPage","per_page","lightbox","SimpleLightbox","getGaleryItems","page","resp","err","onSearch","onClick","e","iziToast","data","createMarkup","rect","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"owBAMA,MAAMA,EAAO,CACX,MAAO,SAAS,cAAc,eAAe,EAC7C,UAAW,SAAS,cAAc,iBAAiB,EACnD,QAAS,SAAS,cAAc,UAAU,EAC1C,QAAS,SAAS,cAAc,UAAU,EAC1C,QAAS,SAAS,cAAc,YAAY,CAC9C,EAEMC,EAAS,CACb,QAAS,oCACX,EACAC,EAAM,SAAS,QAAU,2BAEzB,IAAIC,EAAc,EAClB,MAAMC,EAAW,GACjB,IAAIC,EAAW,IAAIC,EAAe,YAAY,EAE9C,eAAeC,EAAeC,EAAOL,EAAa,CAOhD,OANa,MAAMD,EAChB,IACC,QAAQD,EAAO,aAAaD,EAAK,MAAM,sEAAsEQ,cAAiBJ,GAC/H,EACA,KAAKK,GAAQA,EAAK,IAAI,EACtB,MAAMC,GAAO,QAAQ,MAAMA,CAAG,CAAC,CAGpC,CAEAV,EAAK,UAAU,iBAAiB,QAASW,CAAQ,EACjDX,EAAK,QAAQ,iBAAiB,QAASY,CAAO,EAE9C,SAASD,EAASE,EAAG,CAInB,GAHAA,EAAE,eAAc,EAChBV,EAAc,EAEVH,EAAK,MAAM,MAAM,KAAI,IAAO,GAC9B,OAAOc,EAAS,MAAM,CACpB,QAAS,sCACT,SAAU,UAChB,CAAK,EAEDd,EAAK,QAAQ,UAAY,+BAE3BO,EAAgB,EACb,KAAKQ,GAAQ,CACZf,EAAK,QAAQ,UAAYgB,EAAaD,EAAK,IAAI,EAC/CV,EAAS,QAAO,EAEZD,GAAYW,EAAK,UACnBf,EAAK,QAAQ,OAAS,GAEtBA,EAAK,QAAQ,OAAS,EAE9B,CAAK,EACA,MAAMU,GAAO,QAAQ,MAAMA,CAAG,CAAC,CACpC,CAEA,SAASE,EAAQC,EAAG,CAClBA,EAAE,eAAc,EAChBV,GAAe,EAEfH,EAAK,QAAQ,UAAY,+BACzBA,EAAK,QAAQ,OAAS,GAEtBO,EAAeJ,CAAW,EAAE,KAAKY,GAAQ,CAIvC,GAHAf,EAAK,QAAQ,mBAAmB,YAAagB,EAAaD,EAAK,IAAI,CAAC,EACpEV,EAAS,QAAO,EAEZU,EAAK,UAAYX,GAAYD,EAC/B,OAAAH,EAAK,QAAQ,OAAS,GACtBA,EAAK,QAAQ,UAAY,GAClBc,EAAS,KAAK,CACnB,QAAS,6DACT,SAAU,UAClB,CAAO,EACQC,EAAK,UAAYX,GAAYD,IACtCH,EAAK,QAAQ,UAAY,GACzBA,EAAK,QAAQ,OAAS,IAIxB,IAAIiB,EADe,SAAS,cAAc,eAAe,EACnC,wBACtB,SAAS,CACP,IAAKA,EAAK,OAAS,EACnB,SAAU,QAChB,CAAK,CACL,CAAG,CACH,CAEA,SAASD,EAAaE,EAAK,CACzB,OAAIA,EAAI,SAAW,GACjBJ,EAAS,MAAM,CACb,QACE,gFACF,SAAU,UAChB,CAAK,EAEII,EACJ,IACC,CAAC,CACC,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IACe;AAAA;AAAA,mBAEIL;AAAA,wBACKD,WAAsBE,kBAAqBD;AAAA;AAAA;AAAA,4BAGvCE;AAAA,4BACAC;AAAA,+BACGC;AAAA,gCACCC;AAAA;AAAA,UAI3B,EACA,KAAK,EAAE,CACZ"}